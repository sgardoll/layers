# Phase 15.2: App Store Review Compliance - Implementation Plan

## Problem Analysis

**App Store Review Feedback (Guideline 3.1.2):**
Missing required subscription information in purchase flow and metadata.

**Required in app:**
- ✅ Title of auto-renewing subscription (already shown in paywall)
- ✅ Length of subscription (monthly/annual already shown)
- ✅ Price of subscription (priceString already shown)
- ❌ Functional links to privacy policy and Terms of Use (EULA) - **MISSING**

**Required in metadata (manual App Store Connect updates):**
- Privacy policy link in Privacy Policy field
- Terms of Use (EULA) in App Description or EULA field

## Implementation Approach

### Option 1: Simple Links (Recommended)
Add clickable text links at the bottom of paywall screens that open privacy policy and EULA in browser.

**Pros:**
- Simple to implement
- Works on all iOS versions
- No new dependencies

**Cons:**
- Not native Apple UI
- Less polished than SubscriptionStoreView

### Option 2: SubscriptionStoreView (iOS 17+)
Use Apple's native SubscriptionStoreView component.

**Pros:**
- Native Apple UI
- Automatic compliance with all requirements
- Built-in legal links

**Cons:**
- iOS 17+ only (need fallback for older versions)
- Requires new dependency (StoreKit 2)
- Less control over UI

## Decision: Option 1

Reasoning:
1. The app already has a working paywall UI
2. Only missing piece is legal links
3. Simpler implementation maintains consistency with existing code
4. Works across all iOS versions immediately

## Tasks

### Task 1: Create Privacy Policy and EULA Content
**Files:** 
- `assets/legal/privacy-policy.html`
- `assets/legal/terms-of-use.html`

**Action:**
Create legal documents as HTML files that can be hosted or bundled:
1. Privacy Policy - standard app privacy policy covering data collection, usage, storage
2. Terms of Use (EULA) - end user license agreement for the app

**Verify:** HTML files exist and contain appropriate legal text

**Done:** Both documents created with proper legal language

### Task 2: Add Legal Links to Paywall Screen
**Files:** `lib/screens/paywall_screen.dart`

**Action:**
Add clickable links to privacy policy and EULA at the bottom of paywall:
1. Add url_launcher package to pubspec.yaml
2. Add "By subscribing, you agree to our Terms of Use and Privacy Policy" text
3. Make "Terms of Use" and "Privacy Policy" clickable links
4. Use url_launcher to open documents in browser

**Verify:** Links appear in paywall and open documents when tapped

**Done:** Paywall shows legal links that open correctly

### Task 3: Add Legal Links to Export Purchase Sheet
**Files:** `lib/widgets/export_purchase_sheet.dart`

**Action:**
Same as Task 2 but for the export purchase bottom sheet:
1. Add legal text and links at bottom of purchase sheet
2. Reuse same privacy policy and EULA URLs

**Verify:** Export purchase sheet shows legal links

**Done:** Export purchase sheet includes legal links

### Task 4: Host Legal Documents (Optional)
**Action:**
If not bundling HTML files, host them on:
- GitHub Pages
- Supabase storage public bucket
- Or any static hosting

**Verify:** URLs are accessible and load correctly

**Done:** Documents hosted and URLs work

## Verification Checklist

- [ ] Privacy Policy document created
- [ ] Terms of Use (EULA) document created
- [ ] Legal links added to paywall screen
- [ ] Legal links added to export purchase sheet
- [ ] Links open documents correctly in browser
- [ ] App builds without errors

## Notes for App Store Metadata

These must be done manually in App Store Connect:
1. Add privacy policy URL to "Privacy Policy" field
2. Add EULA to "EULA" field or include in App Description
3. Update App Description if needed to include legal links

## Context Budget Estimate

- Task 1: ~15% (creating HTML content)
- Task 2: ~25% (modifying paywall with url_launcher)
- Task 3: ~15% (modifying export sheet)
- Task 4: ~10% (hosting setup)

Total: ~65% - This fits within a single plan but is on the higher side. Consider splitting Task 1 into its own plan if legal content creation is complex.
