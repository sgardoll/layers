---
phase: 15.2-app-store-compliance
plan: 01
subsystem: legal
subos: ui
tags: [flutter, url_launcher, app-store, eula, privacy-policy]

# Dependency graph
requires:
  - phase: 15-app-store-compliance
    provides: RevenueCat subscription infrastructure
provides:
  - Privacy Policy document (HTML)
  - Terms of Use / EULA document (HTML)
  - Legal links in paywall screen
  - Legal links in export purchase sheet
  - URL launching functionality
affects:
  - Phase 16 (App Store submission - requires legal compliance)
  - Phase 15.3 (Mac App Store compliance)

# Tech tracking
tech-stack:
  added: [url_launcher (already present at ^6.3.2)]
  patterns: [External URL launching with error handling, RichText with clickable spans]

key-files:
  created:
    - assets/legal/privacy-policy.html
    - assets/legal/terms-of-use.html
    - web/privacy-policy.html
    - web/terms-of-use.html
  modified:
    - lib/screens/paywall_screen.dart
    - lib/widgets/export_purchase_sheet.dart

key-decisions:
  - "Used https://layers-app.com domain for hosted legal documents"
  - "Styled legal links with app primary color (#1C39EC) and underline"
  - "Open links in external browser (LaunchMode.externalApplication)"

patterns-established:
  - "Legal links pattern: RichText with TextSpan + TapGestureRecognizer"
  - "URL launch helper with mounted check and error snackbar"

issues-created: []

# Metrics
duration: 22min
completed: 2026-01-31
---

# Phase 15.2 Plan 01: App Store Legal Compliance Summary

**Privacy Policy and Terms of Use (EULA) integrated into subscription flows with url_launcher for App Store Review Guideline 3.1.2 compliance**

## Performance

- **Duration:** 22 min
- **Started:** 2026-01-31T17:09:09Z
- **Completed:** 2026-01-31T17:31:21Z
- **Tasks:** 6/6
- **Files modified:** 4

## Accomplishments

- Created comprehensive Privacy Policy covering data collection, AI processing, third-party services, and user rights
- Created Terms of Use (EULA) with subscription terms, auto-renewal clauses, acceptable use, and platform-specific terms for App Store and Google Play
- Added clickable legal links to paywall screen with styled RichText and TapGestureRecognizer
- Added legal links to export purchase sheet for consistent compliance across all purchase flows
- Configured URLs to point to https://layers-app.com domain for web hosting
- Verified build passes flutter analyze and flutter build ios --simulator

## Task Commits

Each task was committed atomically:

1. **Task 1: Create legal documents** - `9975112` (docs)
2. **Task 2: Add url_launcher** - Pre-existing (no commit needed)
3. **Task 3: Paywall legal links** - `d7f3f17` (feat)
4. **Task 4: Export sheet legal links** - `3f5ab10` (feat)
5. **Task 5: Configure URLs** - `7739700` (chore)
6. **Task 6: Verify build** - `4683e40` (fix)

**Plan metadata:** To be committed with STATE.md update

## Files Created/Modified

### Created
- `assets/legal/privacy-policy.html` - Complete privacy policy with app-specific details
- `assets/legal/terms-of-use.html` - Full EULA with subscription terms and platform clauses
- `web/privacy-policy.html` - Copy for web deployment
- `web/terms-of-use.html` - Copy for web deployment

### Modified
- `lib/screens/paywall_screen.dart` - Added legal links widget with url_launcher integration
- `lib/widgets/export_purchase_sheet.dart` - Added legal links with consistent styling

## Decisions Made

1. **Domain choice**: Used https://layers-app.com as the canonical domain for hosted legal documents. The HTML files are ready in web/ directory for deployment.

2. **Link styling**: Used app primary color (#1C39EC) with underline decoration to match app theme and indicate clickability.

3. **External browser**: Used LaunchMode.externalApplication to open links in system browser, providing users with full browser controls (back, bookmarks, etc.).

4. **Error handling**: Added error snackbar if URL launch fails, providing user feedback instead of silent failure.

## Deviations from Plan

### Auto-fixed Issues

**1. [Rule 3 - Blocking] Removed pre-existing unused import**
- **Found during:** Task 6 (Build verification)
- **Issue:** paywall_screen.dart had unused import of revenuecat_service.dart
- **Fix:** Removed the unused import to clean up analyze warnings
- **Files modified:** lib/screens/paywall_screen.dart
- **Committed in:** 4683e40 (Task 6 commit)

**2. [Rule 1 - Bug] url_launcher already present**
- **Found during:** Task 2
- **Issue:** pubspec.yaml already had url_launcher ^6.3.2, newer than planned ^6.2.5
- **Fix:** No action needed - existing version is compatible and newer
- **Verification:** Package available and functional

---

**Total deviations:** 1 auto-fixed (blocking), 1 already resolved (no action needed)
**Impact on plan:** No impact - all changes were minor cleanups

## Issues Encountered

None

## App Store Metadata Notes

The following information should be added to App Store Connect:

1. **Privacy Policy URL**: https://layers-app.com/privacy-policy
2. **Terms of Use URL**: https://layers-app.com/terms-of-use

**Action required**: Deploy the web/ directory containing privacy-policy.html and terms-of-use.html to your hosting provider (layers-app.com) before App Store submission.

## Next Phase Readiness

- Legal documents created and ready for web deployment
- App code updated with proper legal links in all purchase flows
- Build verified and passing
- **Ready for Phase 16 (App Store submission)** or **Phase 15.3 (Mac App Store compliance)**

---
*Phase: 15.2-app-store-compliance*
*Completed: 2026-01-31*
