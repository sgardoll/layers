# 02.1-03 Summary: Flutter Supabase Client

## Status: COMPLETE

## What Was Done

### Supabase Client Setup
- `lib/core/supabase_client.dart` - initialization with env vars
- Added `supabase_flutter` package

### Project Service (`lib/services/supabase_project_service.dart`)
- `createProject()` - upload image → insert project row → returns immediately
- `subscribeToProject()` - realtime status updates via Stream
- `getProject()` - fetch project by ID
- `getProjectLayers()` - fetch layers for a project
- `deleteProject()` - delete project (triggers BuildShip cleanup)
- `listProjects()` - list user's projects for gallery

### Export Service (`lib/services/supabase_export_service.dart`)
- `createExport()` - insert export row → BuildShip builds it
- `subscribeToExport()` - realtime status updates
- `getExportUrl()` - get signed download URL
- `deleteExport()` - cleanup export

### Riverpod Providers (`lib/providers/supabase_providers.dart`)
- `supabaseProjectServiceProvider`
- `supabaseExportServiceProvider`
- `projectStreamProvider(id)` - realtime project status
- `projectLayersProvider(id)` - layers for project
- `userProjectsProvider` - user's project gallery

### Main App Updated
- `lib/main.dart` - Supabase.initialize() before runApp
- `.env.example` - template for SUPABASE_URL and SUPABASE_ANON_KEY

### Deprecated
- `backend/` → `backend.deprecated/` (old Dart Shelf server)

## Architecture Change

**Before (Phase 2):**
```
Flutter → POST /api/jobs → Dart Server → fal.ai → Poll GET /api/jobs/:id
```

**After (Phase 2.1):**
```
Flutter → INSERT projects → Supabase → Webhook → BuildShip → fal.ai
Flutter ← Realtime subscription ← Supabase (status updates)
```

## Files Created/Modified
- `lib/core/supabase_client.dart` (new)
- `lib/services/supabase_project_service.dart` (new)
- `lib/services/supabase_export_service.dart` (new)
- `lib/providers/supabase_providers.dart` (new)
- `lib/main.dart` (modified)
- `.env.example` (new)

## Next Steps
- Set up BuildShip workflows (02.1-02)
- Update UI to use new providers
